<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë„¤ì´ë²„ ì§€ë„ Geocoder í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .api-config {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .input-group {
            margin: 15px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
        }
        button {
            padding: 12px 20px;
            margin: 10px 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
        }
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        .btn-warning {
            background-color: #ffc107;
            color: #333;
        }
        .btn-danger {
            background-color: #dc3545;
            color: white;
        }
        button:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            max-height: 300px;
            overflow-y: auto;
        }
        .result.success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .result.error {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        .result.info {
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .map-container {
            width: 100%;
            height: 300px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 15px 0;
        }
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <h1>ğŸ—ºï¸ ë„¤ì´ë²„ ì§€ë„ Geocoder í…ŒìŠ¤íŠ¸</h1>

    <!-- API ì„¤ì • ì•Œë¦¼ -->
    <div class="api-config">
        <h3>âš™ï¸ ì„¤ì • ì•ˆë‚´</h3>
        <p><strong>ì¤‘ìš”:</strong> ì´ í˜ì´ì§€ë¥¼ ì‚¬ìš©í•˜ê¸° ì „ì— HTML íŒŒì¼ì˜ ìŠ¤í¬ë¦½íŠ¸ íƒœê·¸ì—ì„œ <code>YOUR_CLIENT_ID</code>ë¥¼ ì‹¤ì œ ë„¤ì´ë²„ ì§€ë„ API í‚¤ë¡œ ë³€ê²½í•´ì£¼ì„¸ìš”!</p>
        <p><strong>í˜„ì¬ API ìƒíƒœ:</strong> <span id="apiStatus">í™•ì¸ ì¤‘...</span></p>
    </div>

    <!-- ì§€ë„ í‘œì‹œ -->
    <div class="test-section">
        <h3>ğŸ—ºï¸ ë„¤ì´ë²„ ì§€ë„</h3>
        <div id="map" class="map-container"></div>
    </div>

    <div class="grid">
        <!-- ì£¼ì†Œ â†’ ì¢Œí‘œ ë³€í™˜ -->
        <div class="test-section">
            <h3>ğŸ“ ì£¼ì†Œ â†’ ì¢Œí‘œ ë³€í™˜ (Geocoding)</h3>
            <div class="input-group">
                <label>ê²€ìƒ‰í•  ì£¼ì†Œ:</label>
                <input type="text" id="addressInput" value="ì„œìš¸ì‹œì²­" placeholder="ì˜ˆ: ì„œìš¸ì‹œì²­, ê°•ë‚¨ì—­">
            </div>
            <button class="btn-primary" onclick="geocodeAddress()" id="geocodingBtn">
                ğŸ” ì£¼ì†Œ ê²€ìƒ‰
            </button>
            <button class="btn-success" onclick="testMultipleAddresses()">
                ğŸ“‹ ì—¬ëŸ¬ ì£¼ì†Œ í…ŒìŠ¤íŠ¸
            </button>
            <div id="geocodingResult" class="result" style="display: none;"></div>
        </div>

        <!-- ì¢Œí‘œ â†’ ì£¼ì†Œ ë³€í™˜ -->
        <div class="test-section">
            <h3>ğŸ  ì¢Œí‘œ â†’ ì£¼ì†Œ ë³€í™˜ (Reverse Geocoding)</h3>
            <div class="input-group">
                <label>ìœ„ë„ (Latitude):</label>
                <input type="number" id="latInput" value="37.5665" step="0.000001" placeholder="ì˜ˆ: 37.5665">
            </div>
            <div class="input-group">
                <label>ê²½ë„ (Longitude):</label>
                <input type="number" id="lngInput" value="126.9780" step="0.000001" placeholder="ì˜ˆ: 126.9780">
            </div>
            <button class="btn-primary" onclick="reverseGeocode()" id="reverseBtn">
                ğŸ” ì¢Œí‘œ ë³€í™˜
            </button>
            <button class="btn-success" onclick="getCurrentLocation()">
                ğŸ“± í˜„ì¬ ìœ„ì¹˜
            </button>
            <div id="reverseResult" class="result" style="display: none;"></div>
        </div>
    </div>

    <!-- ì¢…í•© í…ŒìŠ¤íŠ¸ -->
    <div class="test-section">
        <h3>ğŸ§ª ì¢…í•© í…ŒìŠ¤íŠ¸</h3>
        <button class="btn-success" onclick="runAllTests()">
            ğŸš€ ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        </button>
        <button class="btn-warning" onclick="clearAllResults()">
            ğŸ§¹ ê²°ê³¼ ì§€ìš°ê¸°
        </button>
        <div id="allTestsResult" class="result" style="display: none;"></div>
    </div>
</div>

<!-- ğŸ”‘ ë„¤ì´ë²„ ì§€ë„ API ë¡œë“œ (YOUR_CLIENT_IDë¥¼ ì‹¤ì œ í‚¤ë¡œ ë³€ê²½í•˜ì„¸ìš”!) -->
<script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=vxeo1t8eav&submodules=geocoder"></script>

<script>
    let map;
    let markers = [];

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
    window.onload = function() {
        checkApiStatus();
        initializeMap();
    };

    // API ìƒíƒœ í™•ì¸
    function checkApiStatus() {
        const statusElement = document.getElementById('apiStatus');

        // ë„¤ì´ë²„ ì§€ë„ APIê°€ ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸
        if (typeof naver !== 'undefined' && naver.maps) {
            statusElement.innerHTML = '<span style="color: #28a745;">âœ… ë„¤ì´ë²„ ì§€ë„ API ë¡œë“œ ì„±ê³µ!</span>';

            // Geocoder ì„œë¸Œëª¨ë“ˆì´ ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸
            if (naver.maps.Service && naver.maps.Service.geocode) {
                statusElement.innerHTML += '<br><span style="color: #28a745;">âœ… Geocoder ì„œë¸Œëª¨ë“ˆ ë¡œë“œ ì„±ê³µ!</span>';
            } else {
                statusElement.innerHTML += '<br><span style="color: #dc3545;">âŒ Geocoder ì„œë¸Œëª¨ë“ˆ ë¡œë“œ ì‹¤íŒ¨</span>';
            }
        } else {
            statusElement.innerHTML = '<span style="color: #dc3545;">âŒ ë„¤ì´ë²„ ì§€ë„ API ë¡œë“œ ì‹¤íŒ¨ - API í‚¤ë¥¼ í™•ì¸í•˜ì„¸ìš”!</span>';
        }
    }

    // ì§€ë„ ì´ˆê¸°í™”
    function initializeMap() {
        if (typeof naver === 'undefined' || !naver.maps) {
            console.error('ë„¤ì´ë²„ ì§€ë„ APIê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
            return;
        }

        const mapOptions = {
            center: new naver.maps.LatLng(37.5665, 126.9780), // ì„œìš¸ì‹œì²­
            zoom: 10,
            mapTypeControl: true
        };

        map = new naver.maps.Map('map', mapOptions);
        console.log('ğŸ—ºï¸ ì§€ë„ ì´ˆê¸°í™” ì™„ë£Œ');
    }

    // ë§ˆì»¤ ì¶”ê°€
    function addMarker(lat, lng, title, color = 'red') {
        if (!map) return;

        const marker = new naver.maps.Marker({
            position: new naver.maps.LatLng(lat, lng),
            map: map,
            title: title,
            icon: {
                content: `<div style="background: ${color}; color: white; padding: 5px 8px; border-radius: 15px; font-size: 12px; font-weight: bold;">${title}</div>`,
                anchor: new naver.maps.Point(0, 0)
            }
        });

        markers.push(marker);
        return marker;
    }

    // ëª¨ë“  ë§ˆì»¤ ì œê±°
    function clearMarkers() {
        markers.forEach(marker => marker.setMap(null));
        markers = [];
    }

    // ì£¼ì†Œ â†’ ì¢Œí‘œ ë³€í™˜
    function geocodeAddress() {
        const address = document.getElementById('addressInput').value.trim();
        const resultDiv = document.getElementById('geocodingResult');
        const btn = document.getElementById('geocodingBtn');

        if (!address) {
            alert('ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
            return;
        }

        if (!naver.maps.Service) {
            resultDiv.style.display = 'block';
            resultDiv.className = 'result error';
            resultDiv.textContent = 'âŒ Geocoder ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. API í‚¤ë¥¼ í™•ì¸í•˜ì„¸ìš”!';
            return;
        }

        try {
            btn.disabled = true;
            btn.textContent = 'ê²€ìƒ‰ ì¤‘...';
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = `"${address}" ê²€ìƒ‰ ì¤‘...`;

            naver.maps.Service.geocode({
                query: address
            }, function(status, response) {
                btn.disabled = false;
                btn.textContent = 'ğŸ” ì£¼ì†Œ ê²€ìƒ‰';

                if (status === naver.maps.Service.Status.ERROR) {
                    resultDiv.className = 'result error';
                    resultDiv.textContent = `âŒ ì§€ì˜¤ì½”ë”© ì„œë¹„ìŠ¤ ì˜¤ë¥˜`;
                    return;
                }

                if (response.v2.meta.totalCount === 0) {
                    resultDiv.className = 'result error';
                    resultDiv.textContent = `âŒ "${address}"ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`;
                    return;
                }

                const items = response.v2.addresses;
                let result = `âœ… "${address}" ê²€ìƒ‰ ì„±ê³µ!\n\n`;

                items.forEach((item, index) => {
                    result += `ğŸ“ ê²°ê³¼ ${index + 1}:\n`;
                    result += `   ë„ë¡œëª…: ${item.roadAddress}\n`;
                    result += `   ì§€ë²ˆ: ${item.jibunAddress}\n`;
                    result += `   ì¢Œí‘œ: ${item.y}, ${item.x}\n\n`;
                });

                resultDiv.className = 'result success';
                resultDiv.textContent = result;

                // ì²« ë²ˆì§¸ ê²°ê³¼ë¥¼ ì§€ë„ì— í‘œì‹œ
                const firstItem = items[0];
                const lat = parseFloat(firstItem.y);
                const lng = parseFloat(firstItem.x);

                // ì¢Œí‘œ ì…ë ¥ë€ì— ìë™ ì…ë ¥
                document.getElementById('latInput').value = lat;
                document.getElementById('lngInput').value = lng;

                // ì§€ë„ì— ë§ˆì»¤ ì¶”ê°€ ë° ì´ë™
                clearMarkers();
                addMarker(lat, lng, address, 'blue');
                map.setCenter(new naver.maps.LatLng(lat, lng));
                map.setZoom(15);
            });

        } catch (error) {
            btn.disabled = false;
            btn.textContent = 'ğŸ” ì£¼ì†Œ ê²€ìƒ‰';
            resultDiv.className = 'result error';
            resultDiv.textContent = `âŒ ì˜¤ë¥˜ ë°œìƒ:\n${error.message}`;
        }
    }

    // ì¢Œí‘œ â†’ ì£¼ì†Œ ë³€í™˜
    function reverseGeocode() {
        const lat = parseFloat(document.getElementById('latInput').value);
        const lng = parseFloat(document.getElementById('lngInput').value);
        const resultDiv = document.getElementById('reverseResult');
        const btn = document.getElementById('reverseBtn');

        if (isNaN(lat) || isNaN(lng)) {
            alert('ì˜¬ë°”ë¥¸ ì¢Œí‘œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
            return;
        }

        if (!naver.maps.Service) {
            resultDiv.style.display = 'block';
            resultDiv.className = 'result error';
            resultDiv.textContent = 'âŒ Geocoder ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. API í‚¤ë¥¼ í™•ì¸í•˜ì„¸ìš”!';
            return;
        }

        try {
            btn.disabled = true;
            btn.textContent = 'ë³€í™˜ ì¤‘...';
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = `ì¢Œí‘œ (${lat}, ${lng}) ë³€í™˜ ì¤‘...`;

            naver.maps.Service.reverseGeocode({
                coords: new naver.maps.LatLng(lat, lng),
                orders: [
                    naver.maps.Service.OrderType.ADDR,
                    naver.maps.Service.OrderType.ROAD_ADDR
                ].join(',')
            }, function(status, response) {
                btn.disabled = false;
                btn.textContent = 'ğŸ” ì¢Œí‘œ ë³€í™˜';

                if (status === naver.maps.Service.Status.ERROR) {
                    resultDiv.className = 'result error';
                    resultDiv.textContent = `âŒ ì—­ì§€ì˜¤ì½”ë”© ì„œë¹„ìŠ¤ ì˜¤ë¥˜`;
                    return;
                }

                if (response.v2.results.length === 0) {
                    resultDiv.className = 'result error';
                    resultDiv.textContent = `âŒ ì¢Œí‘œ (${lat}, ${lng})ì— ëŒ€í•œ ì£¼ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`;
                    return;
                }

                const items = response.v2.results;
                let output = `âœ… ì¢Œí‘œ ë³€í™˜ ì„±ê³µ!\n\n`;
                output += `ğŸ“ ì¢Œí‘œ: ${lat}, ${lng}\n\n`;

                items.forEach((item, index) => {
                    output += `ğŸ  ê²°ê³¼ ${index + 1}:\n`;
                    output += `   ì§€ì—­: ${item.region.area1.name} ${item.region.area2.name} ${item.region.area3.name}\n`;
                    if (item.land) {
                        output += `   ì§€ë²ˆ: ${item.land.number1}${item.land.number2 ? '-' + item.land.number2 : ''}\n`;
                        if (item.land.addition0) {
                            output += `   ë„ë¡œëª…: ${item.land.addition0.value}\n`;
                        }
                    }
                    output += '\n';
                });

                resultDiv.className = 'result success';
                resultDiv.textContent = output;

                // ì§€ë„ì— ë§ˆì»¤ ì¶”ê°€ ë° ì´ë™
                clearMarkers();
                addMarker(lat, lng, 'ë³€í™˜ëœ ìœ„ì¹˜', 'green');
                map.setCenter(new naver.maps.LatLng(lat, lng));
                map.setZoom(15);
            });

        } catch (error) {
            btn.disabled = false;
            btn.textContent = 'ğŸ” ì¢Œí‘œ ë³€í™˜';
            resultDiv.className = 'result error';
            resultDiv.textContent = `âŒ ì˜¤ë¥˜ ë°œìƒ:\n${error.message}`;
        }
    }

    // í˜„ì¬ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°
    function getCurrentLocation() {
        const resultDiv = document.getElementById('reverseResult');

        try {
            resultDiv.style.display = 'block';
            resultDiv.className = 'result info';
            resultDiv.textContent = 'í˜„ì¬ ìœ„ì¹˜ í™•ì¸ ì¤‘... (ìœ„ì¹˜ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”)';

            navigator.geolocation.getCurrentPosition(
                function(position) {
                    const { latitude, longitude, accuracy } = position.coords;

                    // ì…ë ¥ë€ì— í˜„ì¬ ìœ„ì¹˜ ì¢Œí‘œ ì„¤ì •
                    document.getElementById('latInput').value = latitude;
                    document.getElementById('lngInput').value = longitude;

                    resultDiv.textContent = `ğŸ“± í˜„ì¬ ìœ„ì¹˜ í™•ì¸ ì™„ë£Œ!\nì¢Œí‘œ: ${latitude}, ${longitude}\nì •í™•ë„: ${Math.round(accuracy)}m\n\nì£¼ì†Œ ë³€í™˜ ì¤‘...`;

                    // ìë™ìœ¼ë¡œ ì£¼ì†Œ ë³€í™˜ ì‹¤í–‰
                    setTimeout(() => {
                        reverseGeocode();
                    }, 500);
                },
                function(error) {
                    let errorMessage = 'í˜„ì¬ ìœ„ì¹˜ í™•ì¸ ì‹¤íŒ¨';

                    if (error.code === 1) {
                        errorMessage = 'ìœ„ì¹˜ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ ìœ„ì¹˜ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.';
                    } else if (error.code === 2) {
                        errorMessage = 'ìœ„ì¹˜ ì •ë³´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                    } else if (error.code === 3) {
                        errorMessage = 'ìœ„ì¹˜ ì°¾ê¸° ì‹œê°„ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤.';
                    }

                    resultDiv.className = 'result error';
                    resultDiv.textContent = `âŒ ${errorMessage}`;
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 300000
                }
            );

        } catch (error) {
            resultDiv.className = 'result error';
            resultDiv.textContent = `âŒ í˜„ì¬ ìœ„ì¹˜ í™•ì¸ ì˜¤ë¥˜: ${error.message}`;
        }
    }

    // ì—¬ëŸ¬ ì£¼ì†Œ í…ŒìŠ¤íŠ¸
    function testMultipleAddresses() {
        const addresses = ['ì„œìš¸ì‹œì²­', 'ê°•ë‚¨ì—­', 'ë¶€ì‚°ì—­', 'ì œì£¼ë„', 'ê´‘í™”ë¬¸', 'í™ëŒ€ì…êµ¬ì—­'];
        const resultDiv = document.getElementById('geocodingResult');
        const btn = event.target;

        if (!naver.maps.Service) {
            resultDiv.style.display = 'block';
            resultDiv.className = 'result error';
            resultDiv.textContent = 'âŒ Geocoder ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
            return;
        }

        btn.disabled = true;
        btn.textContent = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
        resultDiv.style.display = 'block';
        resultDiv.className = 'result info';

        let output = 'ğŸ§ª ì—¬ëŸ¬ ì£¼ì†Œ í…ŒìŠ¤íŠ¸ ì‹œì‘...\n\n';
        resultDiv.textContent = output;

        let completedCount = 0;
        const totalCount = addresses.length;

        addresses.forEach((address, index) => {
            setTimeout(() => {
                output += `ğŸ“ ${address} ê²€ìƒ‰ ì¤‘...\n`;
                resultDiv.textContent = output;

                naver.maps.Service.geocode({
                    query: address
                }, function(status, response) {
                    completedCount++;

                    if (status === naver.maps.Service.Status.OK && response.v2.meta.totalCount > 0) {
                        const item = response.v2.addresses[0];
                        output += `   âœ… ${item.roadAddress}\n`;
                        output += `   ğŸ“ ${item.y}, ${item.x}\n\n`;
                    } else {
                        output += `   âŒ ê²°ê³¼ ì—†ìŒ\n\n`;
                    }

                    resultDiv.textContent = output;

                    if (completedCount === totalCount) {
                        output += 'ğŸ ì—¬ëŸ¬ ì£¼ì†Œ í…ŒìŠ¤íŠ¸ ì™„ë£Œ!';
                        resultDiv.className = 'result success';
                        resultDiv.textContent = output;
                        btn.disabled = false;
                        btn.textContent = 'ğŸ“‹ ì—¬ëŸ¬ ì£¼ì†Œ í…ŒìŠ¤íŠ¸';
                    }
                });
            }, index * 1000); // 1ì´ˆ ê°„ê²©ìœ¼ë¡œ ì‹¤í–‰
        });
    }

    // ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰
    function runAllTests() {
        const resultDiv = document.getElementById('allTestsResult');
        const btn = event.target;

        btn.disabled = true;
        btn.textContent = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
        resultDiv.style.display = 'block';
        resultDiv.className = 'result info';

        let output = 'ğŸš€ ì¢…í•© í…ŒìŠ¤íŠ¸ ì‹œì‘!\n\n';
        resultDiv.textContent = output;

        // 1. API ìƒíƒœ í™•ì¸
        output += '1ï¸âƒ£ API ìƒíƒœ í™•ì¸...\n';
        resultDiv.textContent = output;

        if (typeof naver !== 'undefined' && naver.maps && naver.maps.Service) {
            output += '   âœ… ë„¤ì´ë²„ ì§€ë„ API ì •ìƒ\n';
            output += '   âœ… Geocoder ì„œë¹„ìŠ¤ ì •ìƒ\n\n';
        } else {
            output += '   âŒ API ë¡œë“œ ì‹¤íŒ¨\n\n';
            resultDiv.className = 'result error';
            resultDiv.textContent = output;
            btn.disabled = false;
            btn.textContent = 'ğŸš€ ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰';
            return;
        }

        // 2. ì§€ì˜¤ì½”ë”© í…ŒìŠ¤íŠ¸
        output += '2ï¸âƒ£ ì§€ì˜¤ì½”ë”© í…ŒìŠ¤íŠ¸...\n';
        resultDiv.textContent = output;

        naver.maps.Service.geocode({
            query: 'ì„œìš¸ì‹œì²­'
        }, function(status, response) {
            if (status === naver.maps.Service.Status.OK && response.v2.meta.totalCount > 0) {
                output += '   âœ… ì„œìš¸ì‹œì²­ ê²€ìƒ‰ ì„±ê³µ\n\n';
            } else {
                output += '   âŒ ì„œìš¸ì‹œì²­ ê²€ìƒ‰ ì‹¤íŒ¨\n\n';
            }

            // 3. ì—­ì§€ì˜¤ì½”ë”© í…ŒìŠ¤íŠ¸
            output += '3ï¸âƒ£ ì—­ì§€ì˜¤ì½”ë”© í…ŒìŠ¤íŠ¸...\n';
            resultDiv.textContent = output;

            naver.maps.Service.reverseGeocode({
                coords: new naver.maps.LatLng(37.5665, 126.9780)
            }, function(status, response) {
                if (status === naver.maps.Service.Status.OK && response.v2.results.length > 0) {
                    output += '   âœ… ì¢Œí‘œ ë³€í™˜ ì„±ê³µ\n\n';
                } else {
                    output += '   âŒ ì¢Œí‘œ ë³€í™˜ ì‹¤íŒ¨\n\n';
                }

                output += 'ğŸ‰ ì¢…í•© í…ŒìŠ¤íŠ¸ ì™„ë£Œ!\n';
                output += 'ë„¤ì´ë²„ ì§€ë„ Geocoderê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤! âœ…';

                resultDiv.className = 'result success';
                resultDiv.textContent = output;
                btn.disabled = false;
                btn.textContent = 'ğŸš€ ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰';
            });
        });
    }

    // ëª¨ë“  ê²°ê³¼ ì§€ìš°ê¸°
    function clearAllResults() {
        const results = document.querySelectorAll('.result');
        results.forEach(result => {
            result.style.display = 'none';
            result.textContent = '';
        });
        clearMarkers();
    }

    // Enter í‚¤ ì´ë²¤íŠ¸
    document.getElementById('addressInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') geocodeAddress();
    });

    document.getElementById('latInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') reverseGeocode();
    });

    document.getElementById('lngInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') reverseGeocode();
    });
</script>
</body>
</html>